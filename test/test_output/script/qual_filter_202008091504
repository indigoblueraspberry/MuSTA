#!/bin/bash
#$ -S /bin/bash
#$ -pe def_slot 1
#$ -l s_vmem=32G,mem_req=32G
#$ -q '!mjobs_rerun.q'
#$ -t 1-1 -tc 100

#$ -o /media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/log/others
#$ -e /media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/log/others
#$ -l os7
#$ -sync y
set -eu
declare -a sample=([1]="sample1" [2]="sample2" [3]="sample3" [4]="sample4")
declare -a long_read_hq=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/long_read/polished_01.fasta" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/long_read/polished_02.fasta" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/long_read/polished_03.fasta" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/long_read/polished_04.fasta")
declare -a cluster_report=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/long_read/polished_01.cluster_report.csv" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/long_read/polished_02.cluster_report.csv" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/long_read/polished_03.cluster_report.csv" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/long_read/polished_04.cluster_report.csv")
declare -a short_read_1=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/short_read/sample_01_1.shuffled.fasta" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/short_read/sample_02_1.shuffled.fasta" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/short_read/sample_03_1.shuffled.fasta" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/short_read/sample_04_1.shuffled.fasta")
declare -a short_read_2=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/short_read/sample_01_2.shuffled.fasta" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/short_read/sample_02_2.shuffled.fasta" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/short_read/sample_03_2.shuffled.fasta" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/short_read/sample_04_2.shuffled.fasta")
declare -a long_read_lq=([1]="" [2]="" [3]="" [4]="")
declare -a SJ=([1]="" [2]="" [3]="" [4]="")
declare -a mutation=([1]="" [2]="" [3]="" [4]="")
declare -a sv=([1]="" [2]="" [3]="" [4]="")
declare -a sample_dir=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4")
declare -a long_copy_hq=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/long_read/polished_01.fasta" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/long_read/polished_02.fasta" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/long_read/polished_03.fasta" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/long_read/polished_04.fasta")
declare -a short_copy_1=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/short_read/sample_01_1.shuffled.fasta" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/short_read/sample_02_1.shuffled.fasta" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/short_read/sample_03_1.shuffled.fasta" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/short_read/sample_04_1.shuffled.fasta")
declare -a short_copy_2=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/short_read/sample_01_2.shuffled.fasta" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/short_read/sample_02_2.shuffled.fasta" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/short_read/sample_03_2.shuffled.fasta" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/short_read/sample_04_2.shuffled.fasta")
declare -a interleave=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/interleave.fastq" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/interleave.fastq" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/interleave.fastq" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/interleave.fastq")
declare -a interleave_lordectmp=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/interleave.fastq_k19_s3.h5" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/interleave.fastq_k19_s3.h5" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/interleave.fastq_k19_s3.h5" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/interleave.fastq_k19_s3.h5")
declare -a lordec_hq=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/hq.lordec.fa" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/hq.lordec.fa" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/hq.lordec.fa" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/hq.lordec.fa")
declare -a merged_fa=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/hq.lordec.fa" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/hq.lordec.fa" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/hq.lordec.fa" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/hq.lordec.fa")
declare -a minimap2_hq_sam=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/hq.lordec.sam" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/hq.lordec.sam" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/hq.lordec.sam" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/hq.lordec.sam")
declare -a minimap2_hq_paf=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/hq.lordec.paf" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/hq.lordec.paf" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/hq.lordec.paf" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/hq.lordec.paf")
declare -a qfilt_hq_paf=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/hq.lordec.qfilt.paf" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/hq.lordec.qfilt.paf" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/hq.lordec.qfilt.paf" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/hq.lordec.qfilt.paf")
declare -a qfilt_hq_sam=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/hq.lordec.qfilt.sam" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/hq.lordec.qfilt.sam" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/hq.lordec.qfilt.sam" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/hq.lordec.qfilt.sam")
declare -a samtools_hq_bam=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/hq.lordec.qfilt.sort.bam" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/hq.lordec.qfilt.sort.bam" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/hq.lordec.qfilt.sort.bam" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/hq.lordec.qfilt.sort.bam")
declare -a merged_sam=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/hq.lordec.qfilt.sam" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/hq.lordec.qfilt.sam" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/hq.lordec.qfilt.sam" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/hq.lordec.qfilt.sam")
declare -a samtools_bam=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/hq.lordec.qfilt.sort.bam" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/hq.lordec.qfilt.sort.bam" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/hq.lordec.qfilt.sort.bam" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/hq.lordec.qfilt.sort.bam")
declare -a chimera_paf=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/lordec.qfilt.fusion.txt" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/lordec.qfilt.fusion.txt" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/lordec.qfilt.fusion.txt" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/lordec.qfilt.fusion.txt")
declare -a intra_merge_gtf=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/intra_merge.gtf" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/intra_merge.gtf" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/intra_merge.gtf" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/intra_merge.gtf")
declare -a intra_merge_corr=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/intra_merge.correlation.txt" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/intra_merge.correlation.txt" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/intra_merge.correlation.txt" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/intra_merge.correlation.txt")
declare -a variant_local=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/variant.txt" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/variant.txt" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/variant.txt" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/variant.txt")
declare -a fl_count=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/fl_count.txt" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/fl_count.txt" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/fl_count.txt" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/fl_count.txt")
declare -a salmon_exp_pre_sqanti=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/salmon_init/quant.sf" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/salmon_init/quant.sf" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/salmon_init/quant.sf" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/salmon_init/quant.sf")
declare -a salmon_exp_post_sqanti=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/musta.salmon/quant.sf" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/musta.salmon/quant.sf" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/musta.salmon/quant.sf" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/musta.salmon/quant.sf")
declare -a salmon_exp_ref=([1]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample1/ref.salmon/quant.sf" [2]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample2/ref.salmon/quant.sf" [3]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample3/ref.salmon/quant.sf" [4]="/media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/samples/sample4/ref.salmon/quant.sf")
##########
Rscript --slave --vanilla /media/sinnhazime/HHD/pavilion/long_read/MuSTA/lib/quality_filter_paf_sam.R /media/sinnhazime/HHD/pavilion/long_read/MuSTA/test/test_output/report/IO.summary.csv 50
